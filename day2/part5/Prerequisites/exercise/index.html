
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../overview/exercise/">
      
      
        <link rel="next" href="../../athena/exercise/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.11">
    
    
      
        <title>2 - Prerequisites - Amazon MSK Train-The-Trainer Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-security-group-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Amazon MSK Train-The-Trainer Workshop" class="md-header__button md-logo" aria-label="Amazon MSK Train-The-Trainer Workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon MSK Train-The-Trainer Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2 - Prerequisites
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/vasveena/amazon-msk-ttt-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    vasveena/amazon-msk-ttt-workshop
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Amazon MSK Train-The-Trainer Workshop" class="md-nav__button md-logo" aria-label="Amazon MSK Train-The-Trainer Workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Amazon MSK Train-The-Trainer Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/vasveena/amazon-msk-ttt-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    vasveena/amazon-msk-ttt-workshop
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Part 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Part 1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Kafka overview & Amazon MSK Cluster Creation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Kafka overview & Amazon MSK Cluster Creation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../day1/part1/overview/exercise/" class="md-nav__link">
        1 - Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../day1/part1/Prerequisites/exercise/" class="md-nav__link">
        2 - Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../day1/part1/1_provisoned/exercise/" class="md-nav__link">
        3 - Launching MSK cluster (Provisoned)(Console)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../day1/part1/2_cli/exercise/" class="md-nav__link">
        4 - Launching MSK cluster (Provisoned)(CLI)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Part 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Part 2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Open Monitoring Lab" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Part 3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Part 3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Kafka Migration Lab - MSK to MSK Serverless" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Part 4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Part 4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          Building a Serverless Apache Kafka Data Pipeline
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Building a Serverless Apache Kafka Data Pipeline
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/1_Intro/exercise/" class="md-nav__link">
        1 - Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/2_Setup/exercise/" class="md-nav__link">
        2 - Setup MSK Serverless cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/3_Producer/exercise/" class="md-nav__link">
        3 - Produce clickstream data to MSK Serverless using Elastic Container Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/4_LambdaConsumer/exercise/" class="md-nav__link">
        4 - Consume data from MSK Serverless using Lambda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/5_QS_Dashboard/exercise/" class="md-nav__link">
        5 - Create Quicksight Dashboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../part4/6_KDA_Consumer/exercise/" class="md-nav__link">
        6 - Consume using Kinesis Data Analytics and write to Amazon OpenSearch Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Part 5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Part 5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
          MSK Integration with Athena and Redshift
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          MSK Integration with Athena and Redshift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/exercise/" class="md-nav__link">
        1 - Architecture Introduction
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          2 - Prerequisites
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        2 - Prerequisites
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-security-group-configuration" class="md-nav__link">
    1. Security Group Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-s3-bucket" class="md-nav__link">
    2. Create S3 Bucket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-configure-athena" class="md-nav__link">
    3. Configure Athena
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-setting-up-iam" class="md-nav__link">
    4. Setting up IAM
  </a>
  
    <nav class="md-nav" aria-label="4. Setting up IAM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-iam-policies" class="md-nav__link">
    Create IAM Policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-iam-role" class="md-nav__link">
    Create IAM Role
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-redshift-subnet-group" class="md-nav__link">
    5. Create Redshift Subnet Group
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-create-redshift-cluster" class="md-nav__link">
    6. Create Redshift Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cloud-9-setup" class="md-nav__link">
    7. Cloud 9 Setup
  </a>
  
    <nav class="md-nav" aria-label="7. Cloud 9 Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-kafka-tools" class="md-nav__link">
    Install kafka tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-jq-envsubst" class="md-nav__link">
    Install jq, envsubst
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kafka-setup" class="md-nav__link">
    8. Kafka Setup
  </a>
  
    <nav class="md-nav" aria-label="8. Kafka Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-topic" class="md-nav__link">
    Create Topic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produce-and-consume-data" class="md-nav__link">
    Produce and consume data
  </a>
  
    <nav class="md-nav" aria-label="Produce and consume data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    Data:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-consume-data-from-a-kafka-topic" class="md-nav__link">
    To consume data from a Kafka Topic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../athena/exercise/" class="md-nav__link">
        3 - Integration with Athena
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redshift/exercise/" class="md-nav__link">
        4 - Integration with Redshift
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-security-group-configuration" class="md-nav__link">
    1. Security Group Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-s3-bucket" class="md-nav__link">
    2. Create S3 Bucket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-configure-athena" class="md-nav__link">
    3. Configure Athena
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-setting-up-iam" class="md-nav__link">
    4. Setting up IAM
  </a>
  
    <nav class="md-nav" aria-label="4. Setting up IAM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-iam-policies" class="md-nav__link">
    Create IAM Policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-iam-role" class="md-nav__link">
    Create IAM Role
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-redshift-subnet-group" class="md-nav__link">
    5. Create Redshift Subnet Group
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-create-redshift-cluster" class="md-nav__link">
    6. Create Redshift Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cloud-9-setup" class="md-nav__link">
    7. Cloud 9 Setup
  </a>
  
    <nav class="md-nav" aria-label="7. Cloud 9 Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-kafka-tools" class="md-nav__link">
    Install kafka tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-jq-envsubst" class="md-nav__link">
    Install jq, envsubst
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kafka-setup" class="md-nav__link">
    8. Kafka Setup
  </a>
  
    <nav class="md-nav" aria-label="8. Kafka Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-topic" class="md-nav__link">
    Create Topic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produce-and-consume-data" class="md-nav__link">
    Produce and consume data
  </a>
  
    <nav class="md-nav" aria-label="Produce and consume data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    Data:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-consume-data-from-a-kafka-topic" class="md-nav__link">
    To consume data from a Kafka Topic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>2 - Prerequisites</h1>

<h2 id="1-security-group-configuration">1. Security Group Configuration<a class="headerlink" href="#1-security-group-configuration" title="Permanent link">&para;</a></h2>
<p>Add self route to msk cluster SG </p>
<ol>
<li>Click on Services in the top left corner of the console, and select MSK</li>
<li>Go to the <a href="https://us-east-1.console.aws.amazon.com/msk/home?region=us-east-1#/clusters">MSK</a> (Right click -&gt; Open Link in New Tab) and choose the cluster <strong>MSKCluster-msk-labs-default</strong></li>
<li>Click on <strong>Properties Tab</strong> and scroll down to <strong>Networking settings</strong></li>
<li>In <strong>Networking settings</strong>, under <strong>Primary VPC configuration</strong> look for Security groups applied.</li>
<li>Right click and open the Security Group in a New Tab</li>
<li>Copy the <strong>Security group name</strong></li>
<li>Scroll down and you will find <strong>Inbound rules</strong>, then click <strong>Edit Inbound rules</strong></li>
<li>
<p>Scroll down and Add rule: (Add a self route as below)</p>
<blockquote>
<ul>
<li>Type: All TCP</li>
<li>Protocol: TCP</li>
<li>Port range: 0 - 65535</li>
<li>Source: [paste the value of the Security Group Id you copied in the step-6]</li>
<li>Description: Plaintext Kafka - Lambda </li>
</ul>
</blockquote>
</li>
<li>
<p>Click Save rules</p>
</li>
</ol>
<h2 id="2-create-s3-bucket">2. Create S3 Bucket<a class="headerlink" href="#2-create-s3-bucket" title="Permanent link">&para;</a></h2>
<p>This S3 bucket will be used to store athena query information and spill data information from Lambda connector setup.</p>
<ol>
<li>Navigate to <a href="https://s3.console.aws.amazon.com/s3/home?region=us-east-1">S3 Console</a></li>
<li>Click <strong>Create bucket</strong></li>
<li>In <strong>General configuration</strong>, provide the <strong>Bucket name</strong> as <blockquote>
<p>msk-athena-bucket-&lt; AWS-Account-Number &gt;</p>
</blockquote>
</li>
<li>Scroll down completely and click <strong>Create bucket</strong>.<blockquote>
<p>Leave all other configuration options as default</p>
</blockquote>
</li>
</ol>
<h2 id="3-configure-athena">3. Configure Athena<a class="headerlink" href="#3-configure-athena" title="Permanent link">&para;</a></h2>
<p>This is used to configure Athena result location.</p>
<ol>
<li>Navigate to <a href="https://us-east-1.console.aws.amazon.com/athena/home?region=us-east-1#/query-editor">Athena Console</a></li>
<li>Click on <strong>Settings</strong> tab</li>
<li>In Query result and encryption settings, click on <strong>Manage</strong></li>
<li>In Query result location and encryption, click on <strong>Browse S3</strong></li>
<li>Choose the radio button beside the bucket <strong>msk-athena-bucket-&lt; AWS Account Number &gt;</strong></li>
<li>Click <strong>Choose</strong></li>
<li>Add the folder path to the Location of query result as below:<blockquote>
<ul>
<li>athena-spill/</li>
</ul>
</blockquote>
</li>
<li>Click <strong>Save</strong></li>
</ol>
<h2 id="4-setting-up-iam">4. Setting up IAM<a class="headerlink" href="#4-setting-up-iam" title="Permanent link">&para;</a></h2>
<p>This is used to create IAM policies and IAM role for the redshift cluster</p>
<h3 id="create-iam-policies">Create IAM Policies<a class="headerlink" href="#create-iam-policies" title="Permanent link">&para;</a></h3>
<p>Create an IAM Policy, which provides permission for communication with the Amazon MSK cluster. The policy you need depends on the authentication method used on your cluster, if you use Amazon MSK. See <a href="https://docs.aws.amazon.com/msk/latest/developerguide/kafka_apis_iam.html">Authentication and Authorization for Apache Kafka APIs</a> for authentication methods available in Amazon MSK.</p>
<ol>
<li>Navigate to <a href="https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/policies">IAM Console</a>, Click on left pane and choose <strong>Policies</strong> in <strong>Acess management</strong> section</li>
<li>Click on <strong>Create policy</strong></li>
<li>In <strong>Policy editor</strong>, choose <strong>JSON</strong> button</li>
<li>
<p>Copy and paste the below policy in the <strong>Policy editor</strong> section ( Overwrite the default provided policy )</p>
<blockquote>
<p>An IAM policy for Amazon MSK using unauthenticated access:</p>
</blockquote>
<div class="codehilite"><pre><span></span><code>{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;VisualEditor0&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;kafka:GetBootstrapBrokers&quot;
            ],
            &quot;Resource&quot;: &quot;*&quot;
        }
    ]
}
</code></pre></div>

</li>
<li>
<p>Click <strong>Next</strong></p>
</li>
<li>In <strong>Policy details</strong>, provide below details:<blockquote>
<ul>
<li>Policy name: MSK-unauthenticated-access</li>
<li>Description: An IAM policy for Amazon MSK using unauthenticated access</li>
</ul>
</blockquote>
</li>
<li>Click <strong>Create policy</strong></li>
</ol>
<p>An IAM policy for Amazon MSK when using IAM authentication:</p>
<div class="codehilite"><pre><span></span><code>{
<span class="w">    </span><span class="s2">&quot;Version&quot;</span>:<span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span>,
<span class="w">    </span><span class="s2">&quot;Statement&quot;</span>:<span class="w"> </span>[
<span class="w">        </span>{
<span class="w">            </span><span class="s2">&quot;Sid&quot;</span>:<span class="w"> </span><span class="s2">&quot;MSKIAMpolicy&quot;</span>,
<span class="w">            </span><span class="s2">&quot;Effect&quot;</span>:<span class="w"> </span><span class="s2">&quot;Allow&quot;</span>,
<span class="w">            </span><span class="s2">&quot;Action&quot;</span>:<span class="w"> </span>[
<span class="w">                </span><span class="s2">&quot;kafka-cluster:ReadData&quot;</span>,
<span class="w">                </span><span class="s2">&quot;kafka-cluster:DescribeTopic&quot;</span>,
<span class="w">                </span><span class="s2">&quot;kafka-cluster:Connect&quot;</span>
<span class="w">            </span>],
<span class="w">            </span><span class="s2">&quot;Resource&quot;</span>:<span class="w"> </span>[
<span class="w">                </span><span class="s2">&quot;arn:aws:kafka:*:0123456789:cluster/*/*&quot;</span>,
<span class="w">                </span><span class="s2">&quot;arn:aws:kafka:*:0123456789:topic/*/*/*&quot;</span>
<span class="w">            </span>]
<span class="w">        </span>},
<span class="w">        </span>{
<span class="w">            </span><span class="s2">&quot;Sid&quot;</span>:<span class="w"> </span><span class="s2">&quot;MSKPolicy&quot;</span>,
<span class="w">            </span><span class="s2">&quot;Effect&quot;</span>:<span class="w"> </span><span class="s2">&quot;Allow&quot;</span>,
<span class="w">            </span><span class="s2">&quot;Action&quot;</span>:<span class="w"> </span>[
<span class="w">                </span><span class="s2">&quot;kafka:GetBootstrapBrokers&quot;</span>
<span class="w">            </span>],
<span class="w">            </span><span class="s2">&quot;Resource&quot;</span>:<span class="w"> </span><span class="s2">&quot;*&quot;</span>
<span class="w">        </span>}
<span class="w">    </span>]
}
</code></pre></div>

<h3 id="create-iam-role">Create IAM Role<a class="headerlink" href="#create-iam-role" title="Permanent link">&para;</a></h3>
<p>Create an IAM role with a trust policy that allows your Amazon Redshift cluster to assume the role. For information about how to configure the trust policy for the IAM role, see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Authorizing Amazon Redshift to access other AWS services on your behalf</a>. </p>
<ol>
<li>Navigate to <a href="https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles">IAM Console</a>, Click on left pane and choose <strong>Roles</strong> in <strong>Acess management</strong> section</li>
<li>Click on <strong>Create role</strong></li>
<li>In <strong>Use case</strong>, choose <strong>Ec2</strong> option</li>
<li>In <strong>Use cases for other AWS services</strong>, choose <strong>Redshift</strong> from the drop down</li>
<li>Choose <strong>Redshift - Customizable</strong> and click <strong>Next</strong></li>
<li>Select the above create policy (<strong>MSK-unauthenticated-access</strong>) and Click <strong>Next</strong></li>
<li>In <strong>Role details</strong> section, provide below details:<blockquote>
<p>Role name: MSK-Redshift-role</p>
</blockquote>
</li>
<li>Click <strong>Create role</strong></li>
</ol>
<h2 id="5-create-redshift-subnet-group">5. Create Redshift Subnet Group<a class="headerlink" href="#5-create-redshift-subnet-group" title="Permanent link">&para;</a></h2>
<ol>
<li>Navigate to <a href="https://us-east-1.console.aws.amazon.com/redshiftv2/home?region=us-east-1#subnet-groups">Redshift Console</a>, Click on left pane and choose <strong>Subnet groups</strong> in <strong>Configurations</strong> section</li>
<li>Click <strong>Create cluster subnet group</strong></li>
<li>
<p>In <strong>Cluster subnet group details</strong>, provide below configuration details:</p>
<blockquote>
<p>Name: msk-redshift-vpc
Description: This subnet group contains msk and redshift subnet groups </p>
</blockquote>
</li>
<li>
<p>In <strong>Add subnets</strong> section, go to <strong>VPC</strong> drop down and choose <strong>MSKVPC</strong></p>
</li>
<li>Click on <strong>Add all the subnets for this VPC</strong></li>
<li>Click <strong>Create cluster subnet group</strong></li>
</ol>
<h2 id="6-create-redshift-cluster">6. Create Redshift Cluster<a class="headerlink" href="#6-create-redshift-cluster" title="Permanent link">&para;</a></h2>
<h2 id="7-cloud-9-setup">7. Cloud 9 Setup<a class="headerlink" href="#7-cloud-9-setup" title="Permanent link">&para;</a></h2>
<p>Open <a href="https://us-east-1.console.aws.amazon.com/cloud9/home?region=us-east-1">Cloud9</a> , select the host <strong>msk-labs-default-Cloud9EC2Bastion</strong> and install following tools:</p>
<h3 id="install-kafka-tools">Install kafka tools<a class="headerlink" href="#install-kafka-tools" title="Permanent link">&para;</a></h3>
<p>In this step, you install Apache Kafka client libraries and tools on the cloud9 setup:</p>
<blockquote>
<ul>
<li>wget https://archive.apache.org/dist/kafka/2.6.2/kafka_2.12-2.6.2.tgz</li>
<li>tar -xzf kafka_2.12-2.6.2.tgz</li>
<li>ln -s kafka_2.12-2.6.2 kafka</li>
</ul>
</blockquote>
<h3 id="install-jq-envsubst">Install jq, envsubst<a class="headerlink" href="#install-jq-envsubst" title="Permanent link">&para;</a></h3>
<blockquote>
<p>sudo yum -y install jq gettext bash-completion moreutils</p>
</blockquote>
<h2 id="8-kafka-setup">8. Kafka Setup<a class="headerlink" href="#8-kafka-setup" title="Permanent link">&para;</a></h2>
<h3 id="create-topic"><a href="#create-topic">Create Topic</a><a class="headerlink" href="#create-topic" title="Permanent link">&para;</a></h3>
<ol>
<li>Go to the <a href="https://us-east-1.console.aws.amazon.com/msk/home?region=us-east-1#/clusters">MSK</a> (Right click -&gt; Open Link in New Tab) and choose the cluster <strong>MSKCluster-msk-labs-default</strong></li>
<li>In Cluster summary, Click on <strong>View client information</strong></li>
<li>
<p>Copy any one of the broker-ids(connection string for the private endpoint) from Authentication type - <strong>Plaintext</strong></p>
<blockquote>
<p>Note: You will get three endpoints for each of the brokers. You only need one broker endpoint for the following step.</p>
</blockquote>
</li>
<li>
<p>Now we will be creating a sample topic using cloud9 host.</p>
</li>
<li>Open <a href="https://us-east-1.console.aws.amazon.com/cloud9/home?region=us-east-1">Cloud9</a> , Click open beside the host <strong>msk-labs-default-Cloud9EC2Bastion</strong></li>
<li>Click on icon (+), choose <strong>New Terminal</strong> [Please check the below screenshot]</li>
<li>In the above terminal, first we are going to create a MSK Topic.</li>
</ol>
<p><strong>To create a Kafka Topic</strong>:</p>
<p>Run the following command, replacing BootstrapServerString with one of the broker endpoints that you obtained in the previous step.</p>
<blockquote>
<p>path-to-your-kafka-installation/bin/kafka-topics.sh --create --bootstrap-server BootstrapServerString --replication-factor 3 --partitions 1 --topic MSKTopicName</p>
</blockquote>
<p><strong>Example command</strong>:</p>
<blockquote>
<p>kafka_2.12-2.6.2/bin/kafka-topics.sh --create --bootstrap-server b-1.mskclustermsklabsdefa.1je9hf.c21.kafka.us-east-1.amazonaws.com:9092 --replication-factor 3 --partitions 1 --topic orders</p>
</blockquote>
<p>If the command succeeds, you see the following message: Created topic orders.</p>
<h3 id="produce-and-consume-data">Produce and consume data<a class="headerlink" href="#produce-and-consume-data" title="Permanent link">&para;</a></h3>
<p>To produce and consume messages, in the above terminal itself we will be running the following command to start a console producer.</p>
<p><strong>To produce data to a Kafka Topic</strong>:
Replace BootstrapServerString with the plaintext connection string that you obtained in <a href="#create-topic">create topic</a></p>
<blockquote>
<p>path-to-your-kafka-installation/bin/kafka-console-producer.sh --broker-list BootstrapServerString --producer.config client.properties --topic MSKTopicName</p>
</blockquote>
<p><strong>Example command</strong>:</p>
<blockquote>
<p>kafka_2.12-2.6.2/bin/kafka-console-producer.sh --broker-list b-1.mskclustermsklabsdefa.1je9hf.c21.kafka.us-east-1.amazonaws.com:9092 --topic orders</p>
</blockquote>
<p>Enter the following data, and press Enter. </p>
<h5 id="data"><a href="#data">Data</a>:<a class="headerlink" href="#data" title="Permanent link">&para;</a></h5>
<blockquote>
<ul>
<li>{"customer_id": "000","item_id":1}</li>
<li>{"customer_id": "abe","item_id":2}</li>
<li>{"customer_id": "def","item_id":3}</li>
<li>{"customer_id": "ghi","item_id":4}</li>
<li>{"customer_id": "jkl","item_id":5}</li>
<li>{"customer_id": "mno","item_id":6}</li>
<li>{"customer_id": "pqr","item_id":7}</li>
<li>{"customer_id": "rst","item_id":8}</li>
<li>{"customer_id": "uvw","item_id":9}</li>
<li>{"customer_id": "xyz","item_id":10}</li>
<li>{"customer_id": "000","item_id":11}    </li>
<li>{"customer_id": "abe","item_id":12}  </li>
<li>{"customer_id": "000","item_id":13}</li>
</ul>
<p>Note: Every time you enter a line and press Enter, that line is sent to your Apache Kafka cluster as a separate message.</p>
</blockquote>
<h3 id="to-consume-data-from-a-kafka-topic">To consume data from a Kafka Topic<a class="headerlink" href="#to-consume-data-from-a-kafka-topic" title="Permanent link">&para;</a></h3>
<p>In the below terminal, we will be running the following command to start a console consumer.</p>
<p>Replace BootstrapServerString with the plaintext connection string that you saved earlier.</p>
<blockquote>
<p>path-to-your-kafka-installation/bin/kafka-console-consumer.sh --bootstrap-server BootstrapServerString --topic MSKTopicName --from-beginning</p>
</blockquote>
<p><strong>Example command</strong>:</p>
<blockquote>
<p>kafka_2.12-2.6.2/bin/kafka-console-consumer.sh --bootstrap-server b-1.mskclustermsklabsdefa.1je9hf.c21.kafka.us-east-1.amazonaws.com:9092 --topic orders --from-beginning</p>
</blockquote>
<p>You start seeing the messages you entered earlier when you used the <a href="#data">console producer command</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["tabs"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>